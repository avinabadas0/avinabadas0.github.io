{{ define "main" }}
<header class="l-hero">
    <span class="l-hero__greeting">FullStack Developer</span>
    <h1 class="l-hero__name">Avinaba Das</h1>
    <p class="l-hero__bio">Building robust multitenant architectures, agentic systems, and high-performance applications
        with Rust, React, and AWS.</p>
    <a href="/about" class="btn btn--primary">Deep dive into my work</a>
</header>

<main class="l-grid">
    {{/* Timeline Section */}}
    {{ partial "components/bento-card.html" (dict
    "class" "col-span-8"
    "title" "Timeline"
    "content" (partial "components/timeline-vertical.html" .)
    ) }}

    {{/* Skills Card */}}
    {{ partial "components/bento-card.html" (dict
    "class" "col-span-4"
    "title" "Stack"
    "content" (partial "components/skills-grid.html" .)
    ) }}

    {{/* Featured Project */}}
    {{ range where .Site.RegularPages "Params.featured" true | first 1 }}
    {{ partial "components/bento-card.html" (dict
    "class" "col-span-4 c-card--hero"
    "title" .Title
    "content" (print `<p class='text-body' style='color: var(--color-text-secondary)'>` .Summary `</p><a
        href='` .RelPermalink `' class='btn btn--secondary' style='margin-top: 16px'>Examine Case Study</a>`)
    ) }}
    {{ end }}

    {{/* Github Activity */}}
    {{ partial "components/bento-card.html" (dict
    "class" "col-span-8"
    "title" "Contributions"
    "content" `<div style="display: flex; flex-direction: column; gap: 12px; width: 100%;">
        <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 20px;">
            <div style="display: flex; flex-direction: column; gap: 4px;">
                <span
                    style="font-size: 11px; color: var(--color-text-secondary); text-transform: uppercase; letter-spacing: 0.05em; font-weight: 600;">Commit
                    History</span>
                <span class="text-h3" id="github-contribution-count" style="font-size: 16px; font-weight: 500;">Fetching
                    activity...</span>
            </div>
            <div
                style="display: flex; align-items: center; gap: 6px; padding: 4px 10px; background: var(--color-deep-surface); border-radius: 6px; border: 1px solid var(--color-stroke);">
                <i data-lucide="activity" style="width: 12px; height: 12px; color: var(--color-signal-green);"></i>
                <span style="font-size: 10px; font-weight: 500; color: var(--color-text-secondary);">Verified
                    Graph</span>
            </div>
        </div>

        <div class="git-graph-container dark-only">
            <img src="https://github-contributions-api.deno.dev/mars-s.svg?theme=github-dark&no-total=true&no-legend=true&no-title=true"
                alt="Github contribution grid" style="width: 100%; height: auto;" />
        </div>
        <div class="git-graph-container light-only">
            <img src="https://github-contributions-api.deno.dev/mars-s.svg?theme=github&no-total=true&no-legend=true&no-title=true"
                alt="Github contribution grid" style="width: 100%; height: auto;" />
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center;">
            <a href="https://github.com/mars-s" target="_blank"
                style="display: flex; align-items: center; gap: 8px; text-decoration: none; opacity: 0.7; transition: opacity 0.2s;"
                onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'">
                <i data-lucide="github" style="width: 14px; height: 14px; color: var(--color-text-primary);"></i>
                <span style="font-size: 12px; color: var(--color-text-secondary);">@mars-s on GitHub</span>
            </a>
            <div style="display: flex; align-items: center; gap: 10px; font-size: 11px;">
                <span style="color: var(--color-text-muted);">Less</span>
                <div style="display: flex; gap: 4px;">
                    <div
                        style="width: 10px; height: 10px; background: var(--color-void-black); border: 1px solid var(--color-stroke); border-radius: 2px;">
                    </div>
                    <div style="width: 10px; height: 10px; background: rgba(52, 211, 153, 0.15); border-radius: 2px;">
                    </div>
                    <div style="width: 10px; height: 10px; background: rgba(52, 211, 153, 0.4); border-radius: 2px;">
                    </div>
                    <div style="width: 10px; height: 10px; background: rgba(52, 211, 153, 0.7); border-radius: 2px;">
                    </div>
                    <div style="width: 10px; height: 10px; background: var(--color-signal-green); border-radius: 2px;">
                    </div>
                </div>
                <span style="color: var(--color-text-muted);">More</span>
            </div>
        </div>
    </div>
    <script>
        fetch('https://github-contributions-api.deno.dev/mars-s')
            .then(res => res.json())
            .then(data => {
                const count = data.total.lastYear;
                document.getElementById('github-contribution-count').innerText = count + ' contributions in the last year';
            })
            .catch(() => {
                document.getElementById('github-contribution-count').innerText = '443 contributions in the last year';
            });
    </script>`
    ) }}

    {{/* Latest Blogs */}}
    <div class="col-span-12">
        <div
            style="display: flex; justify-content: space-between; align-items: center; margin: var(--spacing-xl) 0 var(--spacing-md);">
            <h2 class="text-h2">Recent Writing</h2>
            <a href="/blogs" class="btn btn--secondary" style="padding: 6px 16px; font-size: 12px;">All Posts</a>
        </div>

        <div class="blog-list">
            {{ range (where .Site.RegularPages "Section" "blogs") | first 3 }}
            <a href="{{ .RelPermalink }}" class="blog-item">
                <div class="blog-item__main">
                    <h3 class="blog-item__title">{{ .Title }}</h3>
                    <p class="blog-item__desc">{{ .Params.desc | default .Summary }}</p>
                </div>
                <div class="blog-item__meta">
                    <span class="blog-item__date">{{ .Date.Format "Jan 02, 2006" }}</span>
                    <div class="blog-item__pills">
                        {{ with .Params.project }}
                        <div class="blog-pill"><i data-lucide="layers"></i><span>{{ . }}</span></div>
                        {{ end }}

                        {{ $colors := slice "green" "purple" "orange" "pink" }}
                        {{ range $index, $tag := .Params.tags }}
                        {{ $color := index $colors (mod (len $tag) (len $colors)) }}
                        <div class="blog-pill blog-pill--{{ $color }}">
                            <i data-lucide="tag"></i>
                            <span>{{ . }}</span>
                        </div>
                        {{ end }}
                    </div>
                </div>
            </a>
            {{ end }}
        </div>
    </div>
</main>
{{ end }}